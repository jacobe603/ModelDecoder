<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AAON RN Series Model String Parser</title>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #f0f0f0;
            --bg-white: #ffffff;
            --bg-header: #e8e8e8;
            --border-color: #d0d0d0;
            --border-dark: #a0a0a0;
            --accent-blue: #0078d4;
            --accent-blue-light: #e5f3ff;
            --text-primary: #1a1a1a;
            --text-secondary: #444444;
            --text-muted: #666666;
            --row-hover: #f5f5f5;
            --row-alt: #fafafa;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-main);
            color: var(--text-primary);
            font-size: 13px;
            line-height: 1.4;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Header / Title Bar */
        .title-bar {
            background: var(--bg-white);
            border-bottom: 1px solid var(--border-color);
            padding: 8px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .app-icon {
            width: 20px;
            height: 20px;
            background: var(--accent-blue);
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 11px;
        }

        .app-title {
            font-size: 13px;
            color: var(--text-primary);
        }

        /* Model String Display */
        .model-string-bar {
            background: var(--bg-white);
            border-bottom: 1px solid var(--border-color);
            padding: 12px 16px;
        }

        .model-string-input-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .model-string-input {
            flex: 1;
            padding: 6px 10px;
            border: 1px solid var(--border-dark);
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 13px;
            color: var(--text-primary);
            background: var(--bg-white);
        }

        .model-string-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 1px var(--accent-blue);
        }

        .model-string-input::placeholder {
            color: #999;
        }

        /* Tabs */
        .tabs-bar {
            background: var(--bg-white);
            border-bottom: 1px solid var(--border-color);
            padding: 0 16px;
            display: flex;
            gap: 0;
        }

        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: transparent;
            font-family: inherit;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
        }

        .tab-btn:hover {
            background: var(--row-hover);
        }

        .tab-btn.active {
            color: var(--accent-blue);
            border-bottom-color: var(--accent-blue);
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 240px;
            background: var(--bg-white);
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 10px 12px;
            background: #4a7c9b;
            color: white;
            font-weight: 600;
            font-size: 12px;
        }

        .nav-section {
            border-bottom: 1px solid var(--border-color);
        }

        .nav-section-title {
            padding: 8px 12px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            background: var(--bg-header);
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 6px 12px;
            cursor: pointer;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: var(--row-hover);
        }

        .nav-item.active {
            background: var(--accent-blue-light);
            border-left-color: var(--accent-blue);
        }

        .nav-item.child {
            padding-left: 28px;
        }

        .nav-item-code {
            width: 45px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 12px;
        }

        .nav-item-name {
            flex: 1;
            color: var(--text-primary);
            font-size: 12px;
        }

        /* Results Panel */
        .results-panel {
            flex: 1;
            overflow-y: auto;
            background: var(--bg-white);
        }

        .results-header {
            padding: 10px 16px;
            background: #4a7c9b;
            color: white;
            font-weight: 600;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
        }

        .results-table th {
            text-align: left;
            padding: 8px 12px;
            background: var(--bg-header);
            border-bottom: 1px solid var(--border-color);
            font-weight: 600;
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            position: sticky;
            top: 0;
        }

        .results-table td {
            padding: 8px 12px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: top;
        }

        .results-table tr:hover {
            background: var(--row-hover);
        }

        .results-table tr.alt {
            background: var(--row-alt);
        }

        .results-table tr.alt:hover {
            background: var(--row-hover);
        }

        .col-position {
            width: 60px;
            font-weight: 600;
            color: var(--accent-blue);
        }

        .col-code {
            width: 50px;
            font-family: 'Consolas', monospace;
            font-weight: 600;
            background: #f5f5f5;
            text-align: center;
        }

        .col-category {
            width: 180px;
            color: var(--text-secondary);
        }

        .col-description {
            color: var(--text-primary);
        }

        .col-options {
            font-size: 11px;
            color: var(--text-muted);
            max-width: 300px;
        }

        .options-list {
            display: none;
            padding: 4px 0;
            line-height: 1.5;
        }

        .options-list.expanded {
            display: block;
        }

        .option-item {
            padding: 2px 0;
            border-bottom: 1px dotted var(--border-color);
        }

        .option-item:last-child {
            border-bottom: none;
        }

        .option-code {
            font-family: 'Consolas', monospace;
            font-weight: 600;
            color: var(--accent-blue);
            margin-right: 6px;
        }

        .option-current {
            background: var(--accent-blue-light);
            padding: 1px 4px;
            border-radius: 2px;
        }

        .options-toggle {
            cursor: pointer;
            color: var(--accent-blue);
            font-size: 11px;
            padding: 4px 8px;
            border: 1px solid var(--accent-blue);
            border-radius: 3px;
            background: var(--bg-white);
            font-family: inherit;
        }

        .options-toggle:hover {
            background: var(--accent-blue-light);
        }

        .options-toggle:active {
            background: var(--accent-blue);
            color: white;
        }

        .unknown {
            color: #c00;
            font-style: italic;
        }

        /* Search Panel */
        .search-panel {
            display: none;
            flex: 1;
            flex-direction: column;
            background: var(--bg-white);
        }

        .search-panel.active {
            display: flex;
        }

        .parse-panel {
            display: none;
            flex: 1;
            overflow: hidden;
        }

        .parse-panel.active {
            display: flex;
        }

        .search-input-section {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .search-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-dark);
            font-family: inherit;
            font-size: 13px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 1px var(--accent-blue);
        }

        .search-stats {
            padding: 8px 16px;
            background: var(--bg-header);
            border-bottom: 1px solid var(--border-color);
            font-size: 12px;
            color: var(--text-muted);
        }

        .search-results {
            flex: 1;
            overflow-y: auto;
        }

        .search-result-row {
            display: flex;
            padding: 10px 16px;
            border-bottom: 1px solid var(--border-color);
            align-items: flex-start;
            gap: 12px;
        }

        .search-result-row:hover {
            background: var(--row-hover);
        }

        .search-result-code {
            min-width: 50px;
            padding: 4px 8px;
            background: var(--accent-blue);
            color: white;
            font-family: 'Consolas', monospace;
            font-weight: 600;
            font-size: 13px;
            text-align: center;
            border-radius: 2px;
        }

        .search-result-info {
            flex: 1;
        }

        .search-result-category {
            font-size: 11px;
            color: var(--accent-blue);
            font-weight: 600;
            margin-bottom: 2px;
        }

        .search-result-desc {
            color: var(--text-primary);
            font-size: 13px;
        }

        mark {
            background: #fff3cd;
            padding: 0 2px;
        }

        .no-results {
            padding: 40px;
            text-align: center;
            color: var(--text-muted);
        }

        /* Example buttons */
        .examples-row {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-top: 8px;
        }

        .examples-label {
            font-size: 11px;
            color: var(--text-muted);
        }

        .example-btn {
            padding: 4px 10px;
            border: 1px solid var(--border-color);
            background: var(--bg-white);
            font-family: inherit;
            font-size: 11px;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 2px;
        }

        .example-btn:hover {
            background: var(--accent-blue-light);
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        /* Status bar */
        .status-bar {
            background: #4a7c9b;
            color: white;
            padding: 6px 16px;
            font-size: 11px;
            display: flex;
            justify-content: space-between;
        }

        /* Accessibility */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Model string visualization */
        .model-string-viz {
            padding: 16px;
            background: var(--bg-header);
            border-bottom: 1px solid var(--border-color);
        }

        .model-string-viz-label {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .model-string-viz-code {
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 14px;
            letter-spacing: 1px;
            padding: 10px 12px;
            background: var(--bg-white);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            overflow-x: auto;
            white-space: nowrap;
        }

        .model-string-viz-code .highlight {
            background: var(--accent-blue);
            color: white;
            padding: 2px 1px;
            border-radius: 2px;
            font-weight: 600;
        }

        .model-string-viz-code .separator {
            color: var(--text-muted);
        }

        /* Keyboard focus styles */
        .nav-item:focus {
            outline: 2px solid var(--accent-blue);
            outline-offset: -2px;
            background: var(--accent-blue-light);
        }

        .nav-item:focus-visible {
            outline: 2px solid var(--accent-blue);
            outline-offset: -2px;
        }

        /* Dependency validation warnings */
        .validation-panel {
            background: #fff8e6;
            border-bottom: 1px solid #f0c36d;
            max-height: 200px;
            overflow-y: auto;
        }

        .validation-header {
            padding: 8px 12px;
            background: #f5a623;
            color: white;
            font-weight: 600;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            position: sticky;
            top: 0;
        }

        .validation-header-icon {
            font-size: 14px;
        }

        .validation-item {
            padding: 8px 12px;
            border-bottom: 1px solid #f0e0c0;
            font-size: 12px;
            display: flex;
            gap: 10px;
            align-items: flex-start;
        }

        .validation-item:last-child {
            border-bottom: none;
        }

        .validation-item-icon {
            color: #f5a623;
            font-weight: bold;
            flex-shrink: 0;
        }

        .validation-item-text {
            flex: 1;
        }

        .validation-item-condition {
            color: var(--text-secondary);
            font-weight: 600;
        }

        .validation-item-issue {
            color: #8a6d3b;
        }

        .validation-item-hint {
            color: var(--accent-blue);
            font-style: italic;
            margin-top: 2px;
        }

        .results-table tr.has-warning {
            background: #fff8e6;
        }

        .results-table tr.has-warning:hover {
            background: #fff3cd;
        }

        .results-table tr.selected-row {
            background: var(--accent-blue-light);
            outline: 2px solid var(--accent-blue);
            outline-offset: -2px;
        }

        .results-table tr.selected-row.has-warning {
            background: #e8f4fc;
        }

        .warning-badge {
            display: inline-block;
            background: #f5a623;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 3px;
            margin-left: 8px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="title-bar">
            <div class="app-icon">A</div>
            <span class="app-title">AAON RN Series Model String Parser</span>
        </div>

        <div class="model-string-bar">
            <div class="model-string-input-wrapper">
                <label for="model-input" class="visually-hidden">Enter AAON model string to decode</label>
                <input type="text" class="model-string-input" id="model-input"
                       placeholder="Enter model string: RN-025-3-0-BB02-384:A000-D0B-DEH-0BA-0D0000L-00-00B00000B"
                       oninput="parseModelString()"
                       aria-describedby="status-text">
            </div>
            <div class="examples-row">
                <span class="examples-label">Examples:</span>
                <button class="example-btn" onclick="loadExample('RN-025-3-0-BB02-384:A000-D0B-DEH-0BA-0D0000L-00-00B00000B')">25T Gas Heat</button>
                <button class="example-btn" onclick="loadExample('RN-008-8-0-EA09-3LB:GEBE-U00-DHF-B00-00EA00F-00-00C0000VB')">8T ERU</button>
                <button class="example-btn" onclick="loadExample('RN-010-3-0-B602-184:A000-D0B-DEH-0BA-0D0000L-00-00B00000B')">10T Heat Pump</button>
            </div>
            <div class="model-string-viz" id="parse-model-viz" style="margin-top: 12px;">
                <div class="model-string-viz-label">Click a row below to highlight its position</div>
                <div class="model-string-viz-code" id="parse-model-viz-code"></div>
            </div>
        </div>

        <div class="tabs-bar">
            <button class="tab-btn active" onclick="switchTab('parse')">Parse Model String</button>
            <button class="tab-btn" onclick="switchTab('search')">Reverse Search</button>
        </div>

        <div class="main-content">
            <div class="parse-panel active" id="parse-panel">
                <div class="sidebar">
                    <div class="sidebar-header">Unit Details</div>
                    <div id="sidebar-nav"></div>
                </div>
                <div class="results-panel">
                    <div class="results-header">
                        <span>Decoded Options</span>
                        <span id="result-count"></span>
                    </div>
                    <div class="validation-panel" id="validation-panel" style="display: none;" role="alert" aria-live="polite">
                        <div class="validation-header">
                            <span class="validation-header-icon">⚠</span>
                            <span>Code Dependency Warnings</span>
                            <span id="validation-count"></span>
                        </div>
                        <div id="validation-items"></div>
                    </div>
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Position</th>
                                <th>Code</th>
                                <th>Category</th>
                                <th>Description</th>
                                <th>Available Options</th>
                            </tr>
                        </thead>
                        <tbody id="results-body"></tbody>
                    </table>
                </div>
            </div>

            <div class="search-panel" id="search-panel">
                <div class="search-input-section">
                    <label for="search-input" class="visually-hidden">Search for features and codes</label>
                    <input type="text" class="search-input" id="search-input"
                           placeholder="Search for features: hot gas reheat, economizer, BACnet, VFD..."
                           oninput="debouncedSearch()"
                           aria-describedby="search-stats">
                </div>
                <div class="model-string-viz" id="model-string-viz" style="display: none;">
                    <div class="model-string-viz-label">Position in model string</div>
                    <div class="model-string-viz-code" id="model-string-viz-code"></div>
                </div>
                <div class="search-stats" id="search-stats" aria-live="polite">Type to search all available codes and options</div>
                <div class="search-results" id="search-results"></div>
            </div>
        </div>

        <div class="status-bar">
            <span id="status-text" aria-live="polite">Ready</span>
            <span>AAON RN/RQ Series Reference Tool</span>
        </div>
    </div>

    <script>
        // Complete AAON RN Series Code Definitions
        const codeDefinitions = {
            GEN: {
                name: "Generation",
                position: "GEN",
                group: "Model",
                codes: {
                    "RN": "Rooftop - Ninth Generation",
                    "RQ": "Rooftop - Tenth Generation (Geothermal)"
                }
            },
            SIZE: {
                name: "Unit Size",
                position: "SIZE",
                group: "Model",
                codes: {
                    "006": "6 Ton", "007": "7 Ton", "008": "8 Ton", "009": "9 Ton",
                    "010": "10 Ton", "011": "11 Ton", "013": "13 Ton", "014": "14 Ton",
                    "015": "15 Ton", "016": "16 Ton", "018": "18 Ton", "020": "20 Ton",
                    "025": "25 Ton", "030": "30 Ton", "055": "55 Ton", "065": "65 Ton",
                    "075": "75 Ton", "090": "90 Ton", "105": "105 Ton", "120": "120 Ton",
                    "130": "130 Ton", "140": "140 Ton"
                }
            },
            VOLTAGE: {
                name: "Voltage",
                position: "VLT",
                group: "Model",
                codes: {
                    "1": "230V/1Φ/60Hz",
                    "2": "230V/3Φ/60Hz",
                    "3": "460V/3Φ/60Hz",
                    "4": "575V/3Φ/60Hz",
                    "6": "380V/3Φ/50Hz",
                    "8": "208V/3Φ/60Hz",
                    "9": "208V/1Φ/60Hz"
                }
            },
            INTERPROT: {
                name: "Interior Protection",
                position: "CONFIG",
                group: "Model",
                codes: {
                    "0": "Standard - Vertical Discharge and Return",
                    "A": "Interior Corrosion Protection - Vertical Discharge and Return"
                }
            },
            A1: {
                name: "Refrigerant Style",
                position: "A1",
                group: "Cooling",
                codes: {
                    "0": "Air Handling Unit",
                    "B": "R-410A - High Efficiency",
                    "E": "R-410A Variable Capacity Scroll Compressor - High Efficiency",
                    "G": "R-410A Two-Stage Compressor - High Efficiency",
                    "H": "R-410A Variable Capacity Scroll + Two-Stage Compressor - High Efficiency",
                    "K": "R-410A Variable Speed Scroll Compressor - High Efficiency",
                    "L": "R-410A VFD Compatible Tandem Compressors + Microchannel Condenser"
                }
            },
            A2: {
                name: "Unit Configuration",
                position: "A2",
                group: "Cooling",
                codes: {
                    "0": "No Cooling",
                    "A": "Air-Cooled Condenser + Standard Evaporator Coil",
                    "B": "Air-Cooled Condenser + 6 Row Evaporator Coil",
                    "J": "Water-Cooled Condenser + Standard Evaporator Coil",
                    "K": "Water-Cooled Condenser + 6 Row Evaporator Coil",
                    "P": "Air-Cooled Condenser + 6 Row Evaporator Coil + Mixed Air Bypass",
                    "Q": "Air-Cooled Condenser + 6 Row Evaporator Coil + Return Air Bypass",
                    "R": "Water-Cooled Condenser + 6 Row Evaporator Coil + Return Air Bypass",
                    "T": "Water-Cooled Condenser + 6 Row Evaporator Coil + Mixed Air Bypass",
                    "U": "Chilled Water Coil - 4 Row",
                    "W": "Chilled Water Coil - 6 Row",
                    "2": "Non-Compressorized + Standard Evaporator Coil",
                    "4": "Non-Compressorized + 6 Row Evaporator Coil",
                    "6": "Air-Source Heat Pump",
                    "7": "Water-Source/Geothermal Heat Pump"
                }
            },
            A3: {
                name: "Coil Coating",
                position: "A3",
                group: "Cooling",
                codes: {
                    "0": "Standard",
                    "1": "Polymer E-Coated Evaporator and Condenser",
                    "8": "Polymer E-Coated Condenser",
                    "9": "Polymer E-Coated Cooling Coil"
                }
            },
            A4: {
                name: "Cooling/Heat Pump Staging",
                position: "A4",
                group: "Cooling",
                codes: {
                    "0": "No Cooling",
                    "1": "1 Stage",
                    "2": "2 Stage",
                    "4": "4 Stage",
                    "5": "5 Stage",
                    "9": "Modulating - Lead VCC",
                    "A": "Modulating - All VCC",
                    "B": "1 Stage Heat Pump + 1 Stage Auxiliary Heat",
                    "C": "2 Stage Heat Pump + 1 Stage Auxiliary Heat",
                    "D": "4 Stage Heat Pump + 1 Stage Auxiliary Heat",
                    "E": "Modulating Heat Pump - Lead VCC + 1 Stage Aux Heat",
                    "F": "Modulating Heat Pump - All VCC + 1 Stage Aux Heat",
                    "H": "Single Serpentine 8 fpi",
                    "J": "Half Serpentine 8 fpi",
                    "K": "Single Serpentine 10 fpi",
                    "L": "Half Serpentine 10 fpi",
                    "M": "Single Serpentine 12 fpi",
                    "N": "Half Serpentine 12 fpi",
                    "P": "1 Stage Heat Pump + 2 Stage Auxiliary Heat",
                    "Q": "2 Stage Heat Pump + 2 Stage Auxiliary Heat",
                    "R": "4 Stage Heat Pump + 2 Stage Auxiliary Heat",
                    "S": "Modulating Heat Pump - Lead VCC + 2 Stage Aux Heat",
                    "T": "Modulating Heat Pump - All VCC + 2 Stage Aux Heat",
                    "U": "1 Stage Heat Pump + 4 Stage Auxiliary Heat",
                    "V": "2 Stage Heat Pump + 4 Stage Auxiliary Heat",
                    "W": "4 Stage Heat Pump + 4 Stage Auxiliary Heat",
                    "Y": "Modulating Heat Pump - Lead VCC + 4 Stage Aux Heat",
                    "Z": "Modulating Heat Pump - All VCC + 4 Stage Aux Heat"
                }
            },
            B1: {
                name: "Heating Type",
                position: "B1",
                group: "Heating",
                codes: {
                    "0": "No Heating",
                    "1": "Electric Heat",
                    "2": "Natural Gas Aluminized",
                    "3": "Natural Gas Stainless Steel",
                    "4": "High Altitude Natural Gas Aluminized",
                    "5": "High Altitude Natural Gas Stainless Steel",
                    "6": "LP Gas Aluminized",
                    "7": "LP Gas Stainless Steel",
                    "8": "High Altitude LP Gas Aluminized",
                    "9": "High Altitude LP Gas Stainless Steel",
                    "C": "Steam Distributing Standard",
                    "D": "Steam Distributing Polymer E-Coated",
                    "E": "Hot Water Standard",
                    "F": "Hot Water Polymer E-Coated"
                }
            },
            B2: {
                name: "Heating Designation",
                position: "B2",
                group: "Heating",
                codes: {
                    "0": "No Heating",
                    "1": "Heat 1", "2": "Heat 2", "3": "Heat 3", "4": "Heat 4",
                    "6": "Heat 6", "7": "Heat 7", "8": "Heat 8", "9": "Heat 9",
                    "A": "Heat A", "B": "Heat B", "C": "Heat C", "D": "Heat D",
                    "E": "Heat E", "F": "Heat F", "G": "Heat G",
                    "H": "1 Row Coil", "J": "2 Row Coil",
                    "K": "Heat K", "L": "Heat L", "M": "Heat M", "N": "Heat N", "P": "Heat P"
                }
            },
            B3: {
                name: "Heating Staging",
                position: "B3",
                group: "Heating",
                codes: {
                    "0": "No Heating",
                    "1": "1 Stage", "2": "2 Stage", "3": "3 Stage", "4": "4 Stage",
                    "5": "5 Stage", "6": "6 Stage", "7": "7 Stage", "8": "8 Stage",
                    "9": "Modulating Gas/SCR Electric",
                    "A": "Modulating/SCR Electric, 0-10V Control Signal",
                    "B": "High Turndown Modulating Gas",
                    "H": "Single Serpentine 8 fpi",
                    "J": "Half Serpentine 8 fpi",
                    "K": "Single Serpentine 10 fpi",
                    "L": "Half Serpentine 10 fpi",
                    "M": "Single Serpentine 12 fpi",
                    "N": "Half Serpentine 12 fpi"
                }
            },
            F1A: {
                name: "Return/Outside Air Section",
                position: "1A",
                group: "Features",
                codes: {
                    "0": "Manually Adjustable OA Opening + RA Opening",
                    "A": "Economizer",
                    "B": "Economizer + Power Exhaust",
                    "C": "Economizer + Power Return",
                    "D": "Economizer + PE - Discharge Damper Volume Control",
                    "E": "Economizer + PE - Discharge Damper Volume Control + 0-10V External Control",
                    "F": "Low CFM Total Energy Recovery Wheel",
                    "G": "Low CFM Total ERW + Bypass",
                    "H": "Low CFM Sensible ERW",
                    "J": "Low CFM Sensible ERW + Bypass",
                    "K": "100% Outside Air - No Return Air",
                    "L": "Motorized Outside Air Damper + RA Opening",
                    "M": "Motorized Outside Air Damper - No Return Air",
                    "N": "Empty ERW Option Box - No Power Exhaust",
                    "P": "Empty ERW Option Box + Power Exhaust",
                    "Q": "1% Purge Low CFM Total ERW",
                    "R": "1% Purge Low CFM Total ERW + Bypass",
                    "S": "1% Purge Low CFM Sensible ERW",
                    "T": "1% Purge Low CFM Sensible ERW + Bypass",
                    "U": "High CFM Total ERW",
                    "V": "High CFM Total ERW + Bypass",
                    "W": "High CFM Sensible ERW",
                    "Y": "High CFM Sensible ERW + Bypass",
                    "Z": "1% Purge High CFM Total ERW",
                    "1": "1% Purge High CFM Total ERW + Bypass",
                    "2": "1% Purge High CFM Sensible ERW",
                    "3": "1% Purge High CFM Sensible ERW + Bypass",
                    "5": "100% Return Air"
                }
            },
            F1B: {
                name: "Return/Exhaust Blower Config",
                position: "1B",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "A": "1 Blower + Standard Efficiency Motor",
                    "B": "2 Blowers + Standard Efficiency Motor",
                    "C": "1 Blower + Premium Efficiency Motor",
                    "D": "2 Blowers + Premium Efficiency Motors",
                    "E": "1 Blower + Premium Efficiency Motor + 1 VFD",
                    "F": "2 Blowers + Premium Efficiency Motors + 2 Motors on 1 VFD",
                    "G": "2 Blowers + Premium Efficiency Motors + 2 Motors on 2 VFDs",
                    "H": "1 Blower + Premium Efficiency TEFC Motor",
                    "J": "2 Blowers + Premium Efficiency TEFC Motors",
                    "K": "1 Blower + Premium Efficiency TEFC Motor + 1 VFD",
                    "L": "2 Blowers + Premium Efficiency TEFC Motors + 2 Motors on 1 VFD",
                    "M": "2 Blowers + Premium Efficiency TEFC Motors + 2 Motors on 2 VFDs",
                    "N": "1 Blower + Premium Efficiency Motor + 1 VFD + Shaft Grounding",
                    "P": "2 Blowers + Premium Efficiency Motors + 2 Motors on 1 VFD + Shaft Grounding",
                    "Q": "2 Blowers + Premium Efficiency Motors + 2 Motors on 2 VFDs + Shaft Grounding",
                    "R": "1 Blower + Premium Efficiency TEFC Motor + 1 VFD + Shaft Grounding",
                    "S": "2 Blowers + Premium Efficiency TEFC Motors + 2 Motors on 1 VFD + Shaft Grounding",
                    "T": "2 Blowers + Premium Efficiency TEFC Motors + 2 Motors on 2 VFDs + Shaft Grounding"
                }
            },
            F1C: {
                name: "Return/Exhaust Blower",
                position: "1C",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "A": "12\" x 9\" x 2 Forward Curved",
                    "B": "15\" Backward Curved Plenum",
                    "C": "18.5\" Backward Curved Plenum",
                    "D": "22\" Backward Curved Plenum",
                    "F": "27\" Backward Curved Plenum",
                    "G": "22\" Direct Drive Axial Flow",
                    "H": "35.5\" Direct Drive Axial Flow",
                    "J": "15\" BC Plenum - 50% Width with Banding",
                    "K": "18.5\" BC Plenum - 70% Width with Banding",
                    "L": "22\" BC Plenum - 70% Width with Banding",
                    "M": "27\" BC Plenum - 70% Width with Banding",
                    "N": "30\" Backward Curved Plenum",
                    "P": "42\" Direct Drive Axial Flow - 9 Blades",
                    "Q": "42\" Direct Drive Axial Flow - 12 Blades",
                    "R": "24\" Backward Curved Plenum",
                    "S": "33\" Backward Curved Plenum",
                    "T": "12\" x 9\" x 1 Forward Curved"
                }
            },
            F1D: {
                name: "Return/Exhaust Blower Motor",
                position: "1D",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "C": "1 hp - 1760 rpm", "D": "2 hp - 1760 rpm", "E": "3 hp - 1760 rpm",
                    "F": "5 hp - 1760 rpm", "G": "7.5 hp - 1760 rpm", "H": "10 hp - 1760 rpm",
                    "L": "15 hp - 1760 rpm", "M": "20 hp - 1760 rpm",
                    "N": "1 hp - 1170 rpm", "P": "2 hp - 1170 rpm", "Q": "3 hp - 1170 rpm",
                    "R": "5 hp - 1170 rpm", "S": "7.5 hp - 1170 rpm", "T": "10 hp - 1170 rpm",
                    "U": "15 hp - 1170 rpm", "V": "20 hp - 1170 rpm",
                    "3": "25 hp - 1760 rpm", "4": "30 hp - 1760 rpm",
                    "5": "40 hp - 1760 rpm", "6": "50 hp - 1760 rpm"
                }
            },
            F2: {
                name: "Outside Air Control",
                position: "2",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "C": "Fully Modulating Actuator - Sensible Limit",
                    "D": "Fully Modulating Actuator - Enthalpy Limit",
                    "E": "DDC Actuator",
                    "P": "Fully Mod. Actuator - Sensible + CO2 Override",
                    "Q": "Fully Mod. Actuator - Enthalpy + CO2 Override",
                    "R": "DDC Actuator + CO2 Override",
                    "U": "2 Position Actuator",
                    "Y": "Fault Detection and Diagnostics Controller (FDD) Sensible Limit",
                    "Z": "FDD Enthalpy Limit",
                    "1": "FDD Sensible Limit + CO2 Override",
                    "2": "FDD Enthalpy Limit + CO2 Override"
                }
            },
            F3: {
                name: "Heat Options",
                position: "3",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "E": "Discharge Air Override",
                    "K": "Auxiliary Heat K", "L": "Auxiliary Heat L", "M": "Auxiliary Heat M",
                    "N": "Auxiliary Heat N", "P": "Auxiliary Heat P", "Q": "Auxiliary Heat Q",
                    "R": "Auxiliary Heat R", "S": "Auxiliary Heat S", "T": "Auxiliary Heat T",
                    "U": "Auxiliary Heat U", "V": "Auxiliary Heat V", "W": "Auxiliary Heat W"
                }
            },
            F4: {
                name: "Maintenance Options",
                position: "4",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "A": "Field Wired 115V Outlet",
                    "B": "Factory Wired 115V Outlet",
                    "C": "Blower Aux. Contact",
                    "D": "Remote Start/Stop Terminals",
                    "E": "Field Wired 115V Outlet + Blower Aux. Contact",
                    "F": "Field Wired 115V Outlet + Remote Start/Stop Terminals",
                    "G": "Factory Wired 115V Outlet + Blower Aux. Contact",
                    "H": "Factory Wired 115V Outlet + Remote Start/Stop Terminals",
                    "J": "Field Wired 115V Outlet + Blower Aux. Contact + Remote Start/Stop Terminals",
                    "K": "Factory Wired 115V Outlet + Blower Aux. Contact + Remote Start/Stop Terminals",
                    "L": "Blower Aux. Contact + Remote Start/Stop Terminals"
                }
            },
            F5A: {
                name: "Supply Blower Config",
                position: "5A",
                group: "Features",
                codes: {
                    "0": "1 Blower + Standard Efficiency Motor",
                    "A": "2 Blowers + Standard Efficiency Motor",
                    "B": "1 Blower + Premium Efficiency Motor",
                    "C": "2 Blowers + Premium Efficiency Motor",
                    "D": "1 Blower + Premium Efficiency Motor + 1 VFD",
                    "F": "2 Blowers + Premium Efficiency Motors + 2 Motors on 1 VFD",
                    "G": "2 Blowers + Premium Efficiency Motors + 2 Motors on 2 VFDs",
                    "H": "1 Blower + Premium Efficiency TEFC Motor",
                    "J": "2 Blowers + Premium Efficiency TEFC Motors",
                    "K": "1 Blower + Premium Efficiency TEFC Motor + 1 VFD",
                    "L": "2 Blowers + Premium Efficiency TEFC Motors + 2 Motors on 1 VFD",
                    "M": "2 Blowers + Premium Efficiency TEFC Motors + 2 Motors on 2 VFDs",
                    "N": "1 Blower + Premium Efficiency Motor + 1 VFD + Shaft Grounding",
                    "P": "2 Blowers + Premium Efficiency Motors + 2 Motors on 1 VFD + Shaft Grounding",
                    "Q": "2 Blowers + Premium Efficiency Motors + 2 Motors on 2 VFDs + Shaft Grounding",
                    "R": "1 Blower + Premium Efficiency TEFC Motor + 1 VFD + Shaft Grounding",
                    "S": "2 Blowers + Premium Efficiency TEFC Motors + 2 Motors on 1 VFD + Shaft Grounding",
                    "T": "2 Blowers + Premium Efficiency TEFC Motors + 2 Motors on 2 VFDs + Shaft Grounding"
                }
            },
            F5B: {
                name: "Supply Air Blower",
                position: "5B",
                group: "Features",
                codes: {
                    "B": "15\" Backward Curved Plenum",
                    "C": "18.5\" Backward Curved Plenum",
                    "D": "24\" Backward Curved Plenum",
                    "E": "27\" Backward Curved Plenum",
                    "F": "30\" BC Plenum - 90% Width + 1750 rpm Max - Aluminum Wheel",
                    "G": "15\" BC Plenum - 70% Width",
                    "H": "18.5\" BC Plenum - 70% Width",
                    "M": "13.5\" Backward Curved Plenum",
                    "N": "13.5\" BC Plenum - 70% Width",
                    "P": "24\" BC Plenum - 60% Width",
                    "Q": "27\" BC Plenum - 60% Width",
                    "R": "22\" Backward Curved Plenum",
                    "S": "22\" BC Plenum - 70% Width",
                    "T": "17\" Backward Curved Plenum",
                    "U": "17\" BC Plenum - 70% Width",
                    "V": "33\" Backward Curved Plenum",
                    "W": "36.5\" Backward Curved Plenum",
                    "Y": "42.5\" Backward Curved Plenum"
                }
            },
            F5C: {
                name: "Supply Blower Motor",
                position: "5C",
                group: "Features",
                codes: {
                    "C": "1 hp - 1760 rpm", "D": "2 hp - 1760 rpm", "E": "3 hp - 1760 rpm",
                    "F": "5 hp - 1760 rpm", "G": "7.5 hp - 1760 rpm", "H": "10 hp - 1760 rpm",
                    "L": "15 hp - 1760 rpm", "M": "20 hp - 1760 rpm",
                    "N": "1 hp - 1170 rpm", "P": "2 hp - 1170 rpm", "Q": "3 hp - 1170 rpm",
                    "R": "5 hp - 1170 rpm", "S": "7.5 hp - 1170 rpm", "T": "10 hp - 1170 rpm",
                    "U": "15 hp - 1170 rpm", "V": "20 hp - 1170 rpm",
                    "W": "25 hp - 1170 rpm", "Y": "30 hp - 1170 rpm",
                    "3": "25 hp - 1760 rpm", "4": "30 hp - 1760 rpm",
                    "5": "40 hp - 1760 rpm", "6": "50 hp - 1760 rpm"
                }
            },
            F6A: {
                name: "Pre Filter",
                position: "6A",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "A": "2\" Pleated - MERV 8",
                    "B": "Metal Mesh Outside Air Filter",
                    "C": "Lint Screen Filter",
                    "D": "Exhaust Air ERW Filter",
                    "E": "2\" Pleated MERV 8 + Metal Mesh Outside Air Filter",
                    "F": "2\" Pleated MERV 8 + Exhaust Air ERW Filter",
                    "G": "Metal Mesh Outside Air Filter + Exhaust Air ERW Filter",
                    "H": "2\" Pleated MERV 8 + Metal Mesh Outside Air Filter + Exhaust Air ERW Filter"
                }
            },
            F6B: {
                name: "Unit Filter",
                position: "6B",
                group: "Features",
                codes: {
                    "0": "2\" Pleated - MERV 8",
                    "B": "4\" Pleated - MERV 8",
                    "C": "2\" Permanent Filter + Replaceable Media",
                    "F": "4\" Pleated - MERV 11",
                    "G": "4\" Pleated - MERV 13",
                    "H": "4\" Pleated - MERV 14"
                }
            },
            F6C: {
                name: "Filter Options",
                position: "6C",
                group: "Features",
                codes: {
                    "0": "Standard",
                    "A": "Clogged Filter Switch",
                    "B": "Magnehelic Gauge",
                    "C": "Clogged Filter Switch + Magnehelic Gauge"
                }
            },
            F7: {
                name: "Refrigeration Control",
                position: "7",
                group: "Features",
                codes: {
                    "0": "Standard",
                    "A": "5 Min. Time Delay Relay - Comp. Off",
                    "B": "20 Sec. Time Delay Relay - Comp. Staging",
                    "C": "Adjustable Fan Cycling",
                    "D": "Adjustable Compressor Lockout",
                    "E": "Freeze Stats - Each Circuit",
                    "F": "5 Min. Time Delay + 20 Sec. Time Delay Staging",
                    "G": "5 Min. Time Delay + Adjustable Fan Cycling",
                    "H": "5 Min. Time Delay + Adjustable Compressor Lockout",
                    "J": "5 Min. Time Delay + Freeze Stats",
                    "K": "20 Sec. Time Delay Staging + Adjustable Fan Cycling",
                    "L": "20 Sec. Time Delay Staging + Adjustable Compressor Lockout",
                    "M": "20 Sec. Time Delay Staging + Freeze Stats",
                    "N": "Adjustable Fan Cycling + Adjustable Compressor Lockout",
                    "P": "Adjustable Fan Cycling + Freeze Stats",
                    "Q": "Adjustable Compressor Lockout + Freeze Stats",
                    "R": "5 Min. Time Delay + 20 Sec. Staging + Adjustable Fan Cycling",
                    "S": "5 Min. Time Delay + 20 Sec. Staging + Adjustable Compressor Lockout",
                    "T": "5 Min. Time Delay + 20 Sec. Staging + Freeze Stats",
                    "U": "5 Min. Time Delay + Adjustable Fan Cycling + Adjustable Compressor Lockout",
                    "V": "5 Min. Time Delay + Adjustable Fan Cycling + Freeze Stats",
                    "W": "5 Min. Time Delay + Adjustable Compressor Lockout + Freeze Stats",
                    "Y": "20 Sec. Staging + Adjustable Fan Cycling + Adjustable Compressor Lockout",
                    "Z": "20 Sec. Staging + Adjustable Fan Cycling + Freeze Stats",
                    "1": "20 Sec. Staging + Adjustable Compressor Lockout + Freeze Stats",
                    "2": "Adjustable Fan Cycling + Adjustable Compressor Lockout + Freeze Stats",
                    "3": "5 Min. Time Delay + 20 Sec. Staging + Adj. Fan Cycling + Adj. Comp. Lockout",
                    "4": "5 Min. Time Delay + 20 Sec. Staging + Adjustable Fan Cycling + Freeze Stats",
                    "5": "5 Min. Time Delay + 20 Sec. Staging + Adj. Comp. Lockout + Freeze Stats",
                    "6": "5 Min. Time Delay + Adj. Fan Cycling + Adj. Comp. Lockout + Freeze Stats",
                    "7": "20 Sec. Staging + Adj. Fan Cycling + Adj. Comp. Lockout + Freeze Stats",
                    "8": "5 Min. Time Delay + 20 Sec. Staging + Adj. Fan Cycling + Adj. Comp. Lockout + Freeze Stats"
                }
            },
            F8: {
                name: "Refrigeration Options",
                position: "8",
                group: "Features",
                codes: {
                    "0": "Standard",
                    "A": "Hot Gas Bypass Lead Stage (or Lag Stage with Lead VCC)",
                    "B": "Hot Gas Bypass Lead and Lag Stages",
                    "D": "Modulating Hot Gas Reheat",
                    "E": "0°F Low Ambient Lead Stage",
                    "H": "Hot Gas Bypass Lead + Modulating Hot Gas Reheat",
                    "J": "Hot Gas Bypass Lead & Lag + Modulating Hot Gas Reheat",
                    "K": "Hot Gas Bypass Lead + 0°F Low Ambient Lead Stage",
                    "L": "Hot Gas Bypass Lead & Lag + 0°F Low Ambient Lead Stage",
                    "N": "Polymer E-Coated Modulating Hot Gas Reheat",
                    "R": "Hot Gas Bypass Lead + Polymer E-Coated Mod. Hot Gas Reheat",
                    "S": "Hot Gas Bypass Lead & Lag + Polymer E-Coated Mod. Hot Gas Reheat",
                    "T": "Parallel Modulating Hot Gas Reheat Microchannel Coil - Lag Circuit",
                    "U": "Hot Gas Bypass Lead + Parallel Mod. Hot Gas Reheat Microchannel - Lag",
                    "V": "Hot Gas Bypass Lead & Lag + Parallel Mod. Hot Gas Reheat Microchannel - Lag",
                    "W": "Polymer E-Coated Parallel Mod. Hot Gas Reheat Microchannel - Lag Circuit",
                    "Y": "Hot Gas Bypass Lead + Polymer E-Coated Parallel Mod. Reheat Microchannel - Lag",
                    "Z": "Hot Gas Bypass Lead & Lag + Polymer E-Coated Parallel Mod. Reheat Microchannel - Lag",
                    "1": "All Circuit Parallel Modulating Hot Gas Reheat Microchannel Coil",
                    "2": "Hot Gas Bypass Lead + All Circuit Parallel Mod. Hot Gas Reheat Microchannel",
                    "3": "Hot Gas Bypass Lead & Lag + All Circuit Parallel Mod. Hot Gas Reheat Microchannel",
                    "4": "Polymer E-Coated All Circuit Parallel Mod. Hot Gas Reheat Microchannel",
                    "5": "Hot Gas Bypass Lead + Polymer E-Coated All Circuit Parallel Mod. Reheat Microchannel",
                    "6": "Hot Gas Bypass Lead & Lag + Polymer E-Coated All Circuit Parallel Mod. Reheat Microchannel"
                }
            },
            F9: {
                name: "Refrigeration Accessories",
                position: "9",
                group: "Features",
                codes: {
                    "0": "Standard",
                    "A": "Sight Glass",
                    "B": "Compressor Isolation Valves",
                    "C": "Sight Glass + Compressor Isolation Valves",
                    "E": "ECM Condenser Fan - Head Pressure Control",
                    "F": "VFD Controlled Condenser Fans - Variable Speed",
                    "K": "Sight Glass + ECM Condenser Fan Head Pressure Control",
                    "L": "Compressor Isolation Valves + ECM Condenser Fan Head Pressure Control",
                    "M": "Sight Glass + Compressor Isolation Valves + ECM Condenser Fan Head Pressure",
                    "N": "Sight Glass + VFD Controlled Condenser Fans",
                    "P": "Compressor Isolation Valves + VFD Controlled Condenser Fans",
                    "Q": "Sight Glass + Compressor Isolation Valves + VFD Controlled Condenser Fans",
                    "T": "Compressor Isolation Valves (Special Configuration)",
                    "U": "Sight Glass + Compressor Isolation Valves (Special Configuration)"
                }
            },
            F10: {
                name: "Power Options",
                position: "10",
                group: "Features",
                codes: {
                    "0": "Standard Power Block",
                    "A": "100 Amp Power Switch",
                    "B": "150 Amp Power Switch",
                    "C": "225 Amp Power Switch",
                    "D": "400 Amp Power Switch",
                    "E": "600 Amp Power Switch",
                    "F": "60 Amp Power Switch",
                    "5": "800 Amp Power Switch",
                    "6": "1200 Amp Power Switch",
                    "G": "15 Amp Circuit Breaker",
                    "H": "20 Amp Circuit Breaker",
                    "J": "25 Amp Circuit Breaker",
                    "K": "30 Amp Circuit Breaker",
                    "L": "35 Amp Circuit Breaker",
                    "M": "40 Amp Circuit Breaker",
                    "N": "45 Amp Circuit Breaker",
                    "P": "50 Amp Circuit Breaker",
                    "Q": "60 Amp Circuit Breaker",
                    "R": "70 Amp Circuit Breaker",
                    "S": "80 Amp Circuit Breaker",
                    "T": "90 Amp Circuit Breaker",
                    "U": "100 Amp Circuit Breaker",
                    "V": "110 Amp Circuit Breaker",
                    "W": "125 Amp Circuit Breaker",
                    "Y": "150 Amp Circuit Breaker",
                    "Z": "175 Amp Circuit Breaker",
                    "1": "200 Amp Circuit Breaker",
                    "2": "225 Amp Circuit Breaker",
                    "3": "250 Amp Circuit Breaker"
                }
            },
            F11: {
                name: "Safety Options",
                position: "11",
                group: "Features",
                codes: {
                    "0": "Standard",
                    "A": "Return and Supply Air Firestat",
                    "B": "Return Air Smoke Detector",
                    "C": "Supply Air Smoke Detector",
                    "D": "Return Air Smoke Detector + Supply Air Smoke Detector",
                    "E": "Firestat + Return Air Smoke Detector",
                    "F": "Firestat + Supply Air Smoke Detector",
                    "G": "Firestat + Return Air Smoke + Supply Air Smoke Detectors",
                    "H": "Remote Smoke Detector Terminals",
                    "J": "Firestat + Remote Smoke Detector Terminals",
                    "K": "Return Air Smoke Detector + Remote Smoke Terminals",
                    "L": "Supply Air Smoke Detector + Remote Smoke Terminals",
                    "M": "Return + Supply Air Smoke Detectors + Remote Smoke Terminals",
                    "N": "Firestat + Return Air Smoke + Remote Smoke Terminals",
                    "P": "Firestat + Supply Air Smoke + Remote Smoke Terminals",
                    "Q": "Firestat + Return + Supply Air Smoke + Remote Smoke Terminals",
                    "R": "High Condensate Level Switch",
                    "S": "Firestat + High Condensate Level Switch",
                    "T": "Return Air Smoke Detector + High Condensate Level Switch",
                    "U": "Supply Air Smoke Detector + High Condensate Level Switch",
                    "V": "Return + Supply Air Smoke Detectors + High Condensate Switch",
                    "W": "Remote Smoke Terminals + High Condensate Level Switch",
                    "Y": "Firestat + Return Air Smoke + High Condensate Switch",
                    "Z": "Firestat + Supply Air Smoke + High Condensate Switch",
                    "1": "Firestat + Return + Supply Air Smoke + High Condensate Switch",
                    "2": "Firestat + Remote Smoke Terminals + High Condensate Switch",
                    "3": "Return Air Smoke + Remote Terminals + High Condensate Switch",
                    "4": "Supply Air Smoke + Remote Terminals + High Condensate Switch",
                    "5": "Return + Supply Smoke + Remote Terminals + High Condensate Switch",
                    "6": "Firestat + Return Smoke + Remote Terminals + High Condensate",
                    "7": "Firestat + Supply Smoke + Remote Terminals + High Condensate",
                    "8": "Firestat + Return + Supply Smoke + Remote Terminals + High Condensate"
                }
            },
            F12: {
                name: "Controls",
                position: "12",
                group: "Features",
                codes: {
                    "0": "Standard",
                    "A": "Low Limit Controls",
                    "B": "Phase and Brown Out Protection",
                    "C": "Energy Recovery Wheel Defrost",
                    "D": "Energy Recovery Wheel Rotation Detection",
                    "E": "Compressor Power Factor Correction",
                    "F": "Low Limit + Phase/Brown Out Protection",
                    "G": "Low Limit + ERW Defrost",
                    "H": "Low Limit + ERW Rotation Detection",
                    "J": "Low Limit + Compressor Power Factor Correction",
                    "K": "Phase/Brown Out + ERW Defrost",
                    "L": "Phase/Brown Out + ERW Rotation Detection",
                    "M": "Phase/Brown Out + Compressor Power Factor Correction",
                    "N": "ERW Defrost + ERW Rotation Detection",
                    "P": "ERW Defrost + Compressor Power Factor Correction",
                    "Q": "ERW Rotation Detection + Compressor Power Factor Correction",
                    "R": "Low Limit + Phase/Brown Out + ERW Defrost",
                    "S": "Low Limit + Phase/Brown Out + ERW Rotation Detection",
                    "T": "Low Limit + Phase/Brown Out + Comp. Power Factor",
                    "U": "Low Limit + ERW Defrost + ERW Rotation Detection",
                    "V": "Low Limit + ERW Defrost + Comp. Power Factor",
                    "W": "Low Limit + ERW Rotation Detection + Comp. Power Factor",
                    "Y": "Phase/Brown Out + ERW Defrost + ERW Rotation Detection",
                    "Z": "Phase/Brown Out + ERW Defrost + Comp. Power Factor",
                    "1": "Phase/Brown Out + ERW Rotation Detection + Comp. Power Factor",
                    "2": "ERW Defrost + ERW Rotation Detection + Comp. Power Factor",
                    "3": "Low Limit + Phase/Brown Out + ERW Defrost + ERW Rotation",
                    "4": "Low Limit + Phase/Brown Out + ERW Defrost + Comp. Power Factor",
                    "5": "Low Limit + Phase/Brown Out + ERW Rotation + Comp. Power Factor",
                    "6": "Low Limit + ERW Defrost + ERW Rotation + Comp. Power Factor",
                    "7": "Phase/Brown Out + ERW Defrost + ERW Rotation + Comp. Power Factor",
                    "8": "Low Limit + Phase/Brown Out + ERW Defrost + ERW Rotation + Comp. Power Factor"
                }
            },
            F13: {
                name: "Special Controls",
                position: "13",
                group: "Features",
                codes: {
                    "0": "Terminal Block for Thermostat Control",
                    "D": "VAV Unit Controller - VAV Cool + CV Heat",
                    "E": "Constant Volume Unit Controller - CV Cool + CV Heat",
                    "F": "Makeup Air Unit Controller - CV Cool + CV Heat",
                    "L": "Terminal Block for Thermostat Control with Isolation Relays",
                    "U": "Digital Precise Air Controller, D-PAC",
                    "V": "Precise Air Controller, PAC",
                    "Y": "Single Zone VAV Heat Pump Unit Controller - VAV Cool + VAV Heat",
                    "Z": "Constant Volume Heat Pump Unit Controller - CV Cool + CV Heat",
                    "1": "Makeup Air Heat Pump Unit Controller - CV Cool + CV Heat",
                    "2": "Single Zone VAV Unit Controller VAV Cool + CV Heat",
                    "3": "Single Zone VAV Unit Controller VAV Cool + VAV Heat",
                    "4": "Field Installed DDC Controls by Others",
                    "5": "Field Installed DDC Controls Furnished by Others with Isolation Relays",
                    "6": "Factory Installed DDC Controls Furnished by Others with Isolation Relays (SPA)"
                }
            },
            F14A: {
                name: "Preheat Type",
                position: "14A",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "A": "Steam Distributing Preheat Coil - 1 Row",
                    "B": "Steam Distributing Preheat Coil - 2 Row",
                    "C": "Hot Water Preheat Coil - 1 Row",
                    "D": "Hot Water Preheat Coil - 2 Row",
                    "E": "Modulating Electric Preheat",
                    "F": "Outside Airflow Monitoring Size A",
                    "G": "Outside Airflow Monitoring Size B",
                    "H": "Outside Airflow Monitoring Size C",
                    "J": "Outside Airflow Monitoring Size D"
                }
            },
            F14B: {
                name: "Preheat Sizing",
                position: "14B",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "A": "Single Serpentine 8 fpi",
                    "B": "Half Serpentine 8 fpi",
                    "C": "Single Serpentine 10 fpi",
                    "D": "Half Serpentine 10 fpi",
                    "E": "Single Serpentine 12 fpi",
                    "F": "Half Serpentine 12 fpi",
                    "G": "10 kW (7.5 kW @ 208V)",
                    "H": "15 kW (11.3 kW @ 208V)",
                    "J": "20 kW (15 kW @ 208V)",
                    "K": "30 kW (22.5 kW @ 208V)",
                    "L": "40 kW (30 kW @ 208V)",
                    "M": "50 kW (37.6 kW @ 208V)",
                    "N": "60 kW (45.1 kW @ 208V)",
                    "P": "70 kW (52.6 kW @ 208V)",
                    "Q": "80 kW (60.1 kW @ 208V)",
                    "R": "90 kW (67.6 kW @ 208V)",
                    "S": "100 kW (75.1 kW @ 208V)",
                    "T": "110 kW (82.6 kW @ 208V)",
                    "U": "120 kW (90.1 kW @ 208V)"
                }
            },
            F15: {
                name: "Glycol Percentage",
                position: "15",
                group: "Features",
                codes: {
                    "0": "Water or No WSHP with Polymer Energy Recovery Wheel",
                    "C": "Field Adjustable for Glycol %",
                    "D": "Water or No WSHP with Aluminum Energy Recovery Wheel",
                    "E": "Field Adjustable Glycol % with Aluminum Energy Recovery Wheel"
                }
            },
            F16: {
                name: "Interior Cabinet Options",
                position: "16",
                group: "Features",
                codes: {
                    "0": "Standard",
                    "B": "Control Panel Service Lights",
                    "H": "UV Lights",
                    "J": "Compressor Sound Blanket (CSB)",
                    "K": "Control Panel Service Lights + UV Lights",
                    "L": "Control Panel Service Lights + CSB",
                    "M": "UV Lights + CSB",
                    "N": "Control Panel Service Lights + UV Lights + CSB"
                }
            },
            F17: {
                name: "Exterior Cabinet Options",
                position: "17",
                group: "Features",
                codes: {
                    "0": "Standard",
                    "A": "Base Insulation",
                    "B": "Burglar Bars",
                    "C": "Condenser Coil Guards (or Screen)",
                    "D": "Base Insulation + Burglar Bars",
                    "E": "Base Insulation + Condenser Coil Guards",
                    "F": "Burglar Bars + Condenser Coil Guards",
                    "G": "Base Insulation + Burglar Bars + Condenser Coil Guards",
                    "H": "Motorized Relief Dampers",
                    "J": "Base Insulation + Motorized Relief Dampers",
                    "K": "Burglar Bars + Motorized Relief Dampers",
                    "L": "Condenser Coil Guards + Motorized Relief Dampers",
                    "M": "Base Insulation + Burglar Bars + Motorized Relief Dampers",
                    "N": "Base Insulation + Condenser Coil Guards + Motorized Relief Dampers",
                    "P": "Burglar Bars + Condenser Coil Guards + Motorized Relief Dampers",
                    "Q": "Base Insulation + Burglar Bars + Coil Guards + Motorized Relief Dampers"
                }
            },
            F18: {
                name: "Electrical Rating",
                position: "18",
                group: "Features",
                codes: {
                    "0": "Standard - 5 kAIC",
                    "1": "10 kAIC",
                    "2": "35 kAIC",
                    "3": "65 kAIC"
                }
            },
            F19: {
                name: "Code Options",
                position: "19",
                group: "Features",
                codes: {
                    "0": "Standard - ETL U.S.A. Listing",
                    "B": "Chicago - Cool + Gas",
                    "C": "Chicago - Cool + Electric Heat",
                    "D": "Chicago - Cool Only",
                    "E": "Chicago - Gas Only",
                    "F": "Chicago - Electric Heat Only",
                    "G": "Chicago - No Cool + No Heat",
                    "H": "ETL U.S.A. + Canada Listing",
                    "K": "California OSHPD Certification",
                    "L": "Shake Table Cert. (ASCE 7-05/ICC-ES AC 156)",
                    "M": "Seismic Construction (Non-Certified)",
                    "N": "California OSHPD Certification + Chicago",
                    "P": "Shake Table Cert. (ASCE 7-05/ICC-ES AC 156) + Chicago",
                    "Q": "Seismic Construction (Non-Certified) + Chicago"
                }
            },
            F20: {
                name: "Crating",
                position: "20",
                group: "Features",
                codes: {
                    "0": "Standard",
                    "A": "Export Crating",
                    "B": "Export Crating - No Condenser Section",
                    "C": "Shrink Wrap",
                    "D": "Export Crating + Shrink Wrap",
                    "E": "Export Crating (No Condenser) + Shrink Wrap"
                }
            },
            F21: {
                name: "Water-Cooled Condenser",
                position: "21",
                group: "Features",
                codes: {
                    "0": "Standard - None",
                    "A": "Balancing Valves",
                    "B": "Water Flow Switch",
                    "C": "Motorized Shut-off Valve",
                    "D": "Head Pressure Control Valve",
                    "E": "Balancing Valves + Water Flow Switch",
                    "F": "Balancing Valves + Motorized Shut-off Valve",
                    "G": "Balancing Valves + Head Pressure Control Valve",
                    "H": "Water Flow Switch + Motorized Shut-off Valve",
                    "J": "Water Flow Switch + Head Pressure Control Valve",
                    "L": "Balancing Valves + Water Flow Switch + Motorized Shut-off Valve",
                    "M": "Balancing Valves + Water Flow Switch + Head Pressure Control Valve"
                }
            },
            F22: {
                name: "Control Vendors",
                position: "22",
                group: "Features",
                codes: {
                    "0": "None",
                    "V": "VCC-X Controls System + Integrated BACnet MSTP",
                    "W": "VCC-X Controls System + Integrated BACnet MSTP with Specials"
                }
            },
            F23: {
                name: "Type",
                position: "23",
                group: "Features",
                codes: {
                    "B": "Standard - AAON Gray Paint",
                    "U": "Special Pricing Authorization + Special Paint",
                    "X": "Special Pricing Authorization + AAON Gray Paint",
                    "1": "Standard Paint + 2 Year Parts Only Warranty",
                    "4": "Standard Paint + 5 Year Parts Only Warranty",
                    "9": "Standard Paint + 10 Year Parts Only Warranty"
                }
            }
        };

        // Heating capacity data from Table 2 - Electric and Gas Heating Capacities
        const heatingCapacityData = {
            // code: { gasInput: MBH, gasOutput: MBH, electric208: kW, electric230_460_575: kW }
            "1": { gasInput: 60.0, gasOutput: 48.6, electric208: 7.5, electricOther: 10 },
            "2": { gasInput: 90.0, gasOutput: 72.0, electric208: 15.0, electricOther: 20 },
            "3": { gasInput: 100.0, gasOutput: 81.0, electric208: 22.5, electricOther: 30 },
            "4": { gasInput: 270.0, gasOutput: 218.7, electric208: 30.0, electricOther: 40 },
            "5": { gasInput: 140.0, gasOutput: 113.4, electric208: 37.5, electricOther: 50 },
            "6": { gasInput: 390.0, gasOutput: 315.9, electric208: 45.0, electricOther: 60 },
            "7": { gasInput: 160.0, gasOutput: 129.6, electric208: 60.1, electricOther: 80 },
            "8": { gasInput: 405.0, gasOutput: 328.1, electric208: 75.1, electricOther: 100 },
            "9": { gasInput: null, gasOutput: null, electric208: 90.1, electricOther: 120 },
            "A": { gasInput: null, gasOutput: null, electric208: 120.1, electricOther: 160 },
            "B": { gasInput: null, gasOutput: null, electric208: 150.2, electricOther: 200 },
            "C": { gasInput: 540.0, gasOutput: 432.0, electric208: 180.2, electricOther: 240 },
            "D": { gasInput: 810.0, gasOutput: 648.0, electric208: 210.3, electricOther: 280 },
            "E": { gasInput: 1080.0, gasOutput: 864.0, electric208: 240.3, electricOther: 320 },
            "F": { gasInput: 195.0, gasOutput: 156.0, electric208: null, electricOther: null },
            "G": { gasInput: 292.5, gasOutput: 234.0, electric208: null, electricOther: null },
            "K": { gasInput: 150.0, gasOutput: 120.0, electric208: null, electricOther: null },
            "L": { gasInput: 210.0, gasOutput: 168.0, electric208: null, electricOther: null },
            "M": { gasInput: 800.0, gasOutput: 640.0, electric208: null, electricOther: null },
            "N": { gasInput: 1600.0, gasOutput: 1280.0, electric208: null, electricOther: null },
            "P": { gasInput: 2400.0, gasOutput: 1920.0, electric208: null, electricOther: null }
        };

        // Navigation structure matching AAON app
        const navStructure = [
            { key: 'GEN', name: 'Generation', indent: false },
            { key: 'SIZE', name: 'Unit Size', indent: false },
            { key: 'VOLTAGE', name: 'Voltage', indent: false },
            { key: 'INTERPROT', name: 'Interior Protection', indent: false },
            { key: 'A1', name: 'Refrigerant Style', indent: true },
            { key: 'A2', name: 'Unit Configuration', indent: true },
            { key: 'A3', name: 'Coil Coating', indent: true },
            { key: 'A4', name: 'Cooling/Heat Pump Staging', indent: true },
            { key: 'B1', name: 'Heating Type', indent: true },
            { key: 'B2', name: 'Heating Designation', indent: true },
            { key: 'B3', name: 'Heating Staging', indent: true },
        ];

        const featureNavStructure = [
            { key: 'F1A', name: 'Return/Outside Air Section', indent: true },
            { key: 'F1B', name: 'Return/Exhaust Blower Config', indent: true },
            { key: 'F1C', name: 'Return/Exhaust Blower', indent: true },
            { key: 'F1D', name: 'Return/Exhaust Blower Motor', indent: true },
            { key: 'F2', name: 'Outside Air Control', indent: true },
            { key: 'F3', name: 'Heat Options', indent: true },
            { key: 'F4', name: 'Maintenance Options', indent: true },
            { key: 'F5A', name: 'Supply Blower Config', indent: true },
            { key: 'F5B', name: 'Supply Air Blower', indent: true },
            { key: 'F5C', name: 'Supply Blower Motor', indent: true },
            { key: 'F6A', name: 'Pre Filter', indent: true },
            { key: 'F6B', name: 'Unit Filter', indent: true },
            { key: 'F6C', name: 'Filter Options', indent: true },
            { key: 'F7', name: 'Refrigeration Control', indent: true },
            { key: 'F8', name: 'Refrigeration Options', indent: true },
            { key: 'F9', name: 'Refrigeration Accessories', indent: true },
            { key: 'F10', name: 'Power Options', indent: true },
            { key: 'F11', name: 'Safety Options', indent: true },
            { key: 'F12', name: 'Controls', indent: true },
            { key: 'F13', name: 'Special Controls', indent: true },
            { key: 'F14A', name: 'Preheat Type', indent: true },
            { key: 'F14B', name: 'Preheat Sizing', indent: true },
            { key: 'F15', name: 'Glycol Percentage', indent: true },
            { key: 'F16', name: 'Interior Cabinet Options', indent: true },
            { key: 'F17', name: 'Exterior Cabinet Options', indent: true },
            { key: 'F18', name: 'Electrical Rating', indent: true },
            { key: 'F19', name: 'Code Options', indent: true },
            { key: 'F20', name: 'Crating', indent: true },
            { key: 'F21', name: 'Water-Cooled Condenser', indent: true },
            { key: 'F22', name: 'Control Vendors', indent: true },
            { key: 'F23', name: 'Type', indent: true },
        ];

        // Reference model string for visualization
        const REFERENCE_MODEL_STRING = 'RN-025-3-0-BB02-384:A000-D0B-DEH-0BA-0D0000L-00-00B00000B';

        // Position mapping: category -> [start, end] indices in reference string
        const positionMap = {
            'GEN': [0, 2],
            'SIZE': [3, 6],
            'VOLTAGE': [7, 8],
            'INTERPROT': [9, 10],
            'A1': [11, 12],
            'A2': [12, 13],
            'A3': [13, 14],
            'A4': [14, 15],
            'B1': [16, 17],
            'B2': [17, 18],
            'B3': [18, 19],
            'F1A': [20, 21],
            'F1B': [21, 22],
            'F1C': [22, 23],
            'F1D': [23, 24],
            'F2': [25, 26],
            'F3': [26, 27],
            'F4': [27, 28],
            'F5A': [29, 30],
            'F5B': [30, 31],
            'F5C': [31, 32],
            'F6A': [33, 34],
            'F6B': [34, 35],
            'F6C': [35, 36],
            'F7': [37, 38],
            'F8': [38, 39],
            'F9': [39, 40],
            'F10': [40, 41],
            'F11': [41, 42],
            'F12': [42, 43],
            'F13': [43, 44],
            'F14A': [45, 46],
            'F14B': [46, 47],
            'F15': [48, 49],
            'F16': [49, 50],
            'F17': [50, 51],
            'F18': [51, 52],
            'F19': [52, 53],
            'F20': [53, 54],
            'F21': [54, 55],
            'F22': [55, 56],
            'F23': [56, 57]
        };

        // Code dependency rules - defines valid combinations and warns on conflicts
        const dependencyRules = [
            // A1 = 0 (Air Handling Unit) restrictions
            {
                condition: { category: 'A1', codes: ['0'] },
                affects: 'A2',
                validCodes: ['U', 'W', '2', '4'],
                message: 'Air Handling Unit (A1=0) requires Chilled Water (U, W) or Non-Compressorized (2, 4) configuration',
                hint: 'A2 should be U, W, 2, or 4 for AHU'
            },
            {
                condition: { category: 'A1', codes: ['0'] },
                affects: 'A4',
                validCodes: ['H', 'J', 'K', 'L', 'M', 'N'],
                message: 'Air Handling Unit (A1=0) uses serpentine coil configuration options',
                hint: 'A4 should use serpentine options (H-N) for coil config'
            },
            // A1 = K (Variable Speed) + A2 = 6 special case
            {
                condition: { category: 'A1', codes: ['K'], and: { category: 'A2', codes: ['6'] } },
                info: true,
                message: 'Variable Speed Scroll (A1=K) + Heat Pump (A2=6) = Zero Degree Cold Climate Air-Source Heat Pump',
                hint: 'This is a special cold climate heat pump configuration'
            },
            // A2 = 6 or 7 (Heat Pump) requires heat pump staging
            {
                condition: { category: 'A2', codes: ['6', '7'] },
                affects: 'A4',
                validCodes: ['B', 'C', 'D', 'E', 'F', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'Y', 'Z'],
                message: 'Heat Pump configuration (A2=6 or 7) requires heat pump staging options',
                hint: 'A4 should use heat pump staging (B-F, P-Z) with auxiliary heat stages'
            },
            // A2 = J, K, R, T (Water-Cooled) enables Feature 21
            {
                condition: { category: 'A2', codes: ['J', 'K', 'R', 'T'] },
                enables: 'F21',
                info: true,
                message: 'Water-Cooled Condenser (A2=J/K/R/T) enables Water-Cooled Condenser options (F21)',
                hint: 'F21 options (balancing valves, flow switch, etc.) are now applicable'
            },
            // A2 = U or W (Chilled Water) - refrigeration options don't apply
            {
                condition: { category: 'A2', codes: ['U', 'W'] },
                affects: 'F7',
                validCodes: ['0'],
                message: 'Chilled Water configuration (A2=U/W) - Refrigeration Control options not applicable',
                hint: 'F7 should be 0 (Standard) for chilled water units'
            },
            {
                condition: { category: 'A2', codes: ['U', 'W'] },
                affects: 'F8',
                validCodes: ['0'],
                message: 'Chilled Water configuration (A2=U/W) - Refrigeration Options not applicable',
                hint: 'F8 should be 0 (Standard) for chilled water units'
            },
            {
                condition: { category: 'A2', codes: ['U', 'W'] },
                affects: 'F9',
                validCodes: ['0'],
                message: 'Chilled Water configuration (A2=U/W) - Refrigeration Accessories not applicable',
                hint: 'F9 should be 0 (Standard) for chilled water units'
            },
            // B1 = 0 (No Heating) restrictions
            {
                condition: { category: 'B1', codes: ['0'] },
                affects: 'B2',
                validCodes: ['0'],
                message: 'No Heating (B1=0) requires B2 to be 0',
                hint: 'B2 should be 0 when there is no heating'
            },
            {
                condition: { category: 'B1', codes: ['0'] },
                affects: 'B3',
                validCodes: ['0'],
                message: 'No Heating (B1=0) requires B3 to be 0',
                hint: 'B3 should be 0 when there is no heating'
            },
            // B1 = C, D, E, F (Steam/Hot Water) uses coil rows for B2 and serpentine for B3
            {
                condition: { category: 'B1', codes: ['C', 'D', 'E', 'F'] },
                affects: 'B2',
                validCodes: ['H', 'J'],
                message: 'Steam/Hot Water heating (B1=C/D/E/F) uses coil row options for B2',
                hint: 'B2 should be H (1 Row) or J (2 Row) for steam/hot water'
            },
            {
                condition: { category: 'B1', codes: ['C', 'D', 'E', 'F'] },
                affects: 'B3',
                validCodes: ['H', 'J', 'K', 'L', 'M', 'N'],
                message: 'Steam/Hot Water heating (B1=C/D/E/F) uses serpentine options for B3',
                hint: 'B3 should use serpentine options (H-N) for steam/hot water'
            },
            // F1A = ERW options enable F12 options C, D
            {
                condition: { category: 'F1A', codes: ['F', 'G', 'H', 'J', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'Y', 'Z', '1', '2', '3'] },
                enables: 'F12',
                enabledCodes: ['C', 'D', 'G', 'H', 'K', 'L', 'N', 'R', 'S', 'U', 'Y', '2', '3', '6', '7', '8'],
                info: true,
                message: 'Energy Recovery Wheel (ERW) configuration enables ERW Defrost/Rotation Detection options in F12',
                hint: 'F12 options C (Defrost) and D (Rotation Detection) are now applicable'
            },
            // F1A = K or M (100% OA) - return blower options may not apply
            {
                condition: { category: 'F1A', codes: ['K', 'M'] },
                affects: 'F1B',
                validCodes: ['0'],
                message: '100% Outside Air configuration (F1A=K/M) - Return blower options typically not needed',
                hint: 'F1B should typically be 0 for 100% OA units (no return air)'
            },
            {
                condition: { category: 'F1A', codes: ['K', 'M'] },
                affects: 'F1C',
                validCodes: ['0'],
                message: '100% Outside Air configuration (F1A=K/M) - Return blower not needed',
                hint: 'F1C should be 0 for 100% OA units'
            },
            {
                condition: { category: 'F1A', codes: ['K', 'M'] },
                affects: 'F1D',
                validCodes: ['0'],
                message: '100% Outside Air configuration (F1A=K/M) - Return blower motor not needed',
                hint: 'F1D should be 0 for 100% OA units'
            },
            // F1B = 0 (No Return Blower) restrictions
            {
                condition: { category: 'F1B', codes: ['0'] },
                affects: 'F1C',
                validCodes: ['0'],
                message: 'No Return Blower Config (F1B=0) requires F1C to be 0',
                hint: 'F1C should be 0 when there is no return blower'
            },
            {
                condition: { category: 'F1B', codes: ['0'] },
                affects: 'F1D',
                validCodes: ['0'],
                message: 'No Return Blower Config (F1B=0) requires F1D to be 0',
                hint: 'F1D should be 0 when there is no return blower'
            },
            // F14A = 0 (No Preheat) restrictions
            {
                condition: { category: 'F14A', codes: ['0'] },
                affects: 'F14B',
                validCodes: ['0'],
                message: 'No Preheat (F14A=0) requires F14B to be 0',
                hint: 'F14B should be 0 when there is no preheat'
            },
            // F14A = A, B (Steam Preheat) uses serpentine options
            {
                condition: { category: 'F14A', codes: ['A', 'B'] },
                affects: 'F14B',
                validCodes: ['A', 'B', 'C', 'D', 'E', 'F'],
                message: 'Steam Preheat (F14A=A/B) uses serpentine sizing options',
                hint: 'F14B should use serpentine options (A-F) for steam preheat'
            },
            // F14A = C, D (Hot Water Preheat) uses serpentine options
            {
                condition: { category: 'F14A', codes: ['C', 'D'] },
                affects: 'F14B',
                validCodes: ['A', 'B', 'C', 'D', 'E', 'F'],
                message: 'Hot Water Preheat (F14A=C/D) uses serpentine sizing options',
                hint: 'F14B should use serpentine options (A-F) for hot water preheat'
            },
            // F14A = E (Electric Preheat) uses kW options
            {
                condition: { category: 'F14A', codes: ['E'] },
                affects: 'F14B',
                validCodes: ['G', 'H', 'J', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'U'],
                message: 'Electric Preheat (F14A=E) uses kW sizing options',
                hint: 'F14B should use kW options (G-U) for electric preheat'
            }
        ];

        // Validate code dependencies and return warnings
        function validateDependencies(results) {
            const warnings = [];
            const codeMap = {};

            // Build a map of category -> code for quick lookup
            results.forEach(r => {
                codeMap[r.category] = r.code;
            });

            // Check each rule
            dependencyRules.forEach(rule => {
                const conditionCategory = rule.condition.category;
                const conditionCodes = rule.condition.codes;

                // Check if the condition is met
                if (!codeMap[conditionCategory] || !conditionCodes.includes(codeMap[conditionCategory])) {
                    return; // Condition not met, skip this rule
                }

                // Check for compound condition (and clause)
                if (rule.condition.and) {
                    const andCategory = rule.condition.and.category;
                    const andCodes = rule.condition.and.codes;
                    if (!codeMap[andCategory] || !andCodes.includes(codeMap[andCategory])) {
                        return; // Compound condition not met
                    }
                }

                // If this is just an info rule (no validation needed)
                if (rule.info && !rule.affects) {
                    warnings.push({
                        type: 'info',
                        conditionCategory,
                        conditionCode: codeMap[conditionCategory],
                        message: rule.message,
                        hint: rule.hint
                    });
                    return;
                }

                // Check the affected category
                if (rule.affects && codeMap[rule.affects]) {
                    const affectedCode = codeMap[rule.affects];
                    if (!rule.validCodes.includes(affectedCode)) {
                        warnings.push({
                            type: 'warning',
                            conditionCategory,
                            conditionCode: codeMap[conditionCategory],
                            affectedCategory: rule.affects,
                            affectedCode,
                            validCodes: rule.validCodes,
                            message: rule.message,
                            hint: rule.hint
                        });
                    }
                }
            });

            return warnings;
        }

        // Render validation warnings in the UI
        function renderValidationWarnings(warnings) {
            const panel = document.getElementById('validation-panel');
            const itemsContainer = document.getElementById('validation-items');
            const countSpan = document.getElementById('validation-count');

            if (warnings.length === 0) {
                panel.style.display = 'none';
                return [];
            }

            const warningCount = warnings.filter(w => w.type === 'warning').length;
            const infoCount = warnings.filter(w => w.type === 'info').length;

            let countText = '';
            if (warningCount > 0) countText += `${warningCount} warning${warningCount !== 1 ? 's' : ''}`;
            if (warningCount > 0 && infoCount > 0) countText += ', ';
            if (infoCount > 0) countText += `${infoCount} info`;
            countSpan.textContent = `(${countText})`;

            itemsContainer.innerHTML = warnings.map(w => `
                <div class="validation-item">
                    <span class="validation-item-icon">${w.type === 'warning' ? '⚠' : 'ℹ'}</span>
                    <div class="validation-item-text">
                        <div class="validation-item-condition">
                            ${w.conditionCategory}=${w.conditionCode}${w.affectedCategory ? ` → ${w.affectedCategory}=${w.affectedCode}` : ''}
                        </div>
                        <div class="validation-item-issue">${w.message}</div>
                        <div class="validation-item-hint">${w.hint}</div>
                    </div>
                </div>
            `).join('');

            panel.style.display = 'block';

            // Return affected categories for highlighting in table
            return warnings.filter(w => w.type === 'warning').map(w => w.affectedCategory);
        }

        // Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Debounced search - 150ms delay
        const debouncedSearch = debounce(performSearch, 150);

        let currentResults = [];

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
            document.getElementById('parse-panel').classList.remove('active');
            document.getElementById('search-panel').classList.remove('active');
            
            if (tab === 'parse') {
                document.querySelector('.tab-btn:first-child').classList.add('active');
                document.getElementById('parse-panel').classList.add('active');
            } else {
                document.querySelector('.tab-btn:last-child').classList.add('active');
                document.getElementById('search-panel').classList.add('active');
            }
        }

        function loadExample(example) {
            document.getElementById('model-input').value = example;
            parseModelString();
        }

        function buildSidebar(results) {
            const nav = document.getElementById('sidebar-nav');
            const resultKeys = results.map(r => r.category);

            let html = '<div class="nav-section"><div class="nav-section-title">Model Options</div>';

            navStructure.forEach((item, index) => {
                const isActive = resultKeys.includes(item.key);
                html += `<div class="nav-item ${item.indent ? 'child' : ''} ${isActive ? 'active' : ''}"
                    tabindex="0"
                    role="button"
                    aria-label="${item.name}"
                    data-nav-index="${index}"
                    onclick="scrollToRow('${item.key}')"
                    onkeydown="handleNavKeydown(event, '${item.key}')">
                    <span class="nav-item-code">${codeDefinitions[item.key]?.position || item.key}</span>
                    <span class="nav-item-name">${item.name}</span>
                </div>`;
            });

            html += '</div><div class="nav-section"><div class="nav-section-title">Feature Options</div>';

            featureNavStructure.forEach((item, index) => {
                const isActive = resultKeys.includes(item.key);
                const globalIndex = navStructure.length + index;
                html += `<div class="nav-item ${item.indent ? 'child' : ''} ${isActive ? 'active' : ''}"
                    tabindex="0"
                    role="button"
                    aria-label="${item.name}"
                    data-nav-index="${globalIndex}"
                    onclick="scrollToRow('${item.key}')"
                    onkeydown="handleNavKeydown(event, '${item.key}')">
                    <span class="nav-item-code">${codeDefinitions[item.key]?.position || item.key}</span>
                    <span class="nav-item-name">${item.name}</span>
                </div>`;
            });

            html += '</div>';
            nav.innerHTML = html;
        }

        function handleNavKeydown(event, key) {
            const navItems = document.querySelectorAll('.nav-item[tabindex="0"]');
            const currentIndex = Array.from(navItems).findIndex(el => el === event.target);

            switch(event.key) {
                case 'Enter':
                case ' ':
                    event.preventDefault();
                    scrollToRow(key);
                    break;
                case 'ArrowDown':
                    event.preventDefault();
                    if (currentIndex < navItems.length - 1) {
                        navItems[currentIndex + 1].focus();
                    }
                    break;
                case 'ArrowUp':
                    event.preventDefault();
                    if (currentIndex > 0) {
                        navItems[currentIndex - 1].focus();
                    }
                    break;
                case 'Home':
                    event.preventDefault();
                    navItems[0].focus();
                    break;
                case 'End':
                    event.preventDefault();
                    navItems[navItems.length - 1].focus();
                    break;
            }
        }

        function scrollToRow(key) {
            const row = document.querySelector(`tr[data-key="${key}"]`);
            if (row) {
                row.scrollIntoView({ behavior: 'smooth', block: 'center' });
                // Highlight the position in the model string
                highlightParsePosition(key);
            }
        }

        function parseModelString() {
            const input = document.getElementById('model-input').value.toUpperCase().trim();
            const resultsBody = document.getElementById('results-body');
            const resultCount = document.getElementById('result-count');
            
            if (!input) {
                resultsBody.innerHTML = '<tr><td colspan="5" class="no-results">Enter a model string to decode</td></tr>';
                buildSidebar([]);
                resultCount.textContent = '';
                document.getElementById('status-text').textContent = 'Ready';
                return;
            }

            const normalized = input.replace(/[–—]/g, '-');
            const [modelPart, featurePart] = normalized.split(':');
            
            if (!modelPart) {
                resultsBody.innerHTML = '<tr><td colspan="5" class="no-results">Invalid model string format</td></tr>';
                return;
            }

            const results = [];
            const modelSegments = modelPart.split('-').filter(s => s);
            
            if (modelSegments.length >= 1) {
                results.push({ category: 'GEN', code: modelSegments[0], ...lookup('GEN', modelSegments[0]) });
            }
            if (modelSegments.length >= 2) {
                const size = modelSegments[1].padStart(3, '0');
                results.push({ category: 'SIZE', code: size, ...lookup('SIZE', size) });
            }
            if (modelSegments.length >= 3) {
                results.push({ category: 'VOLTAGE', code: modelSegments[2], ...lookup('VOLTAGE', modelSegments[2]) });
            }
            if (modelSegments.length >= 4) {
                results.push({ category: 'INTERPROT', code: modelSegments[3], ...lookup('INTERPROT', modelSegments[3]) });
            }
            if (modelSegments.length >= 5) {
                const coolingOpts = modelSegments[4];
                if (coolingOpts.length >= 1) results.push({ category: 'A1', code: coolingOpts[0], ...lookup('A1', coolingOpts[0]) });
                if (coolingOpts.length >= 2) results.push({ category: 'A2', code: coolingOpts[1], ...lookup('A2', coolingOpts[1]) });
                if (coolingOpts.length >= 3) results.push({ category: 'A3', code: coolingOpts[2], ...lookup('A3', coolingOpts[2]) });
                if (coolingOpts.length >= 4) results.push({ category: 'A4', code: coolingOpts[3], ...lookup('A4', coolingOpts[3]) });
            }
            if (modelSegments.length >= 6) {
                const heatingOpts = modelSegments[5];
                if (heatingOpts.length >= 1) results.push({ category: 'B1', code: heatingOpts[0], ...lookup('B1', heatingOpts[0]) });
                if (heatingOpts.length >= 2) results.push({ category: 'B2', code: heatingOpts[1], ...lookup('B2', heatingOpts[1]) });
                if (heatingOpts.length >= 3) results.push({ category: 'B3', code: heatingOpts[2], ...lookup('B3', heatingOpts[2]) });
            }

            if (featurePart) {
                const featureSegments = featurePart.split('-').filter(s => s);
                
                if (featureSegments[0] && featureSegments[0].length >= 4) {
                    const seg = featureSegments[0];
                    results.push({ category: 'F1A', code: seg[0], ...lookup('F1A', seg[0]) });
                    results.push({ category: 'F1B', code: seg[1], ...lookup('F1B', seg[1]) });
                    results.push({ category: 'F1C', code: seg[2], ...lookup('F1C', seg[2]) });
                    results.push({ category: 'F1D', code: seg[3], ...lookup('F1D', seg[3]) });
                }
                if (featureSegments[1] && featureSegments[1].length >= 3) {
                    const seg = featureSegments[1];
                    results.push({ category: 'F2', code: seg[0], ...lookup('F2', seg[0]) });
                    results.push({ category: 'F3', code: seg[1], ...lookup('F3', seg[1]) });
                    results.push({ category: 'F4', code: seg[2], ...lookup('F4', seg[2]) });
                }
                if (featureSegments[2] && featureSegments[2].length >= 3) {
                    const seg = featureSegments[2];
                    results.push({ category: 'F5A', code: seg[0], ...lookup('F5A', seg[0]) });
                    results.push({ category: 'F5B', code: seg[1], ...lookup('F5B', seg[1]) });
                    results.push({ category: 'F5C', code: seg[2], ...lookup('F5C', seg[2]) });
                }
                if (featureSegments[3] && featureSegments[3].length >= 3) {
                    const seg = featureSegments[3];
                    results.push({ category: 'F6A', code: seg[0], ...lookup('F6A', seg[0]) });
                    results.push({ category: 'F6B', code: seg[1], ...lookup('F6B', seg[1]) });
                    results.push({ category: 'F6C', code: seg[2], ...lookup('F6C', seg[2]) });
                }
                if (featureSegments[4] && featureSegments[4].length >= 7) {
                    const seg = featureSegments[4];
                    results.push({ category: 'F7', code: seg[0], ...lookup('F7', seg[0]) });
                    results.push({ category: 'F8', code: seg[1], ...lookup('F8', seg[1]) });
                    results.push({ category: 'F9', code: seg[2], ...lookup('F9', seg[2]) });
                    results.push({ category: 'F10', code: seg[3], ...lookup('F10', seg[3]) });
                    results.push({ category: 'F11', code: seg[4], ...lookup('F11', seg[4]) });
                    results.push({ category: 'F12', code: seg[5], ...lookup('F12', seg[5]) });
                    results.push({ category: 'F13', code: seg[6], ...lookup('F13', seg[6]) });
                }
                if (featureSegments[5] && featureSegments[5].length >= 2) {
                    const seg = featureSegments[5];
                    results.push({ category: 'F14A', code: seg[0], ...lookup('F14A', seg[0]) });
                    results.push({ category: 'F14B', code: seg[1], ...lookup('F14B', seg[1]) });
                }
                if (featureSegments[6] && featureSegments[6].length >= 9) {
                    const seg = featureSegments[6];
                    results.push({ category: 'F15', code: seg[0], ...lookup('F15', seg[0]) });
                    results.push({ category: 'F16', code: seg[1], ...lookup('F16', seg[1]) });
                    results.push({ category: 'F17', code: seg[2], ...lookup('F17', seg[2]) });
                    results.push({ category: 'F18', code: seg[3], ...lookup('F18', seg[3]) });
                    results.push({ category: 'F19', code: seg[4], ...lookup('F19', seg[4]) });
                    results.push({ category: 'F20', code: seg[5], ...lookup('F20', seg[5]) });
                    results.push({ category: 'F21', code: seg[6], ...lookup('F21', seg[6]) });
                    results.push({ category: 'F22', code: seg[7], ...lookup('F22', seg[7]) });
                    results.push({ category: 'F23', code: seg[8], ...lookup('F23', seg[8]) });
                }
            }

            // Enhance B2 with heating capacity based on B1 (heating type) and voltage
            enhanceHeatingCapacity(results);

            currentResults = results;
            buildSidebar(results);

            // Validate dependencies and get warnings
            const warnings = validateDependencies(results);
            const warningCategories = renderValidationWarnings(warnings);

            // Render results with warning highlights
            renderResults(results, warningCategories);

            // Update the model string visualization
            updateParseVisualization();

            const warningCount = warnings.filter(w => w.type === 'warning').length;
            resultCount.textContent = `${results.length} options decoded${warningCount > 0 ? `, ${warningCount} warning${warningCount !== 1 ? 's' : ''}` : ''}`;
            document.getElementById('status-text').textContent = `Parsed ${results.length} options from model string${warningCount > 0 ? ` (${warningCount} dependency warning${warningCount !== 1 ? 's' : ''})` : ''}`;
        }

        // Enhance B2 heating designation with capacity data based on B1 and voltage
        function enhanceHeatingCapacity(results) {
            // Find B1 (heating type), B2 (heating designation), and VOLTAGE in results
            const b1Result = results.find(r => r.category === 'B1');
            const b2Result = results.find(r => r.category === 'B2');
            const voltageResult = results.find(r => r.category === 'VOLTAGE');

            if (!b2Result || !b1Result || b2Result.code === '0') return;

            const capacityData = heatingCapacityData[b2Result.code];
            if (!capacityData) return;

            const b1Code = b1Result.code;
            const voltageCode = voltageResult ? voltageResult.code : '3'; // default to 460V

            // Determine heating type
            const isElectric = b1Code === '1';
            const isGas = ['2', '3', '4', '5', '6', '7', '8', '9'].includes(b1Code);
            const isSteamOrHotWater = ['C', 'D', 'E', 'F'].includes(b1Code);

            let capacityStr = '';

            if (isElectric) {
                // Electric heat - check voltage
                const is208V = voltageCode === '8' || voltageCode === '9';
                if (is208V && capacityData.electric208 !== null) {
                    capacityStr = ` — ${capacityData.electric208} kW @ 208V`;
                } else if (!is208V && capacityData.electricOther !== null) {
                    // Determine voltage label
                    let voltageLabel = '230/460/575V';
                    if (voltageCode === '1' || voltageCode === '2') voltageLabel = '230V';
                    else if (voltageCode === '3') voltageLabel = '460V';
                    else if (voltageCode === '4') voltageLabel = '575V';
                    else if (voltageCode === '6') voltageLabel = '380V';
                    capacityStr = ` — ${capacityData.electricOther} kW @ ${voltageLabel}`;
                }
            } else if (isGas) {
                // Gas heat - show input capacity
                if (capacityData.gasInput !== null) {
                    capacityStr = ` — ${capacityData.gasInput} MBH Input (${capacityData.gasOutput} MBH Output)`;
                }
            }
            // Steam/Hot Water coils don't have fixed capacities in this table

            if (capacityStr) {
                b2Result.description += capacityStr;
            }
        }

        function lookup(category, code) {
            const def = codeDefinitions[category];
            if (!def) return { name: 'Unknown', description: 'Unknown category', position: category };

            const description = def.codes[code];
            return {
                name: def.name,
                position: def.position,
                description: description || 'Unknown code'
            };
        }

        function renderResults(results, warningCategories = []) {
            const tbody = document.getElementById('results-body');

            tbody.innerHTML = results.map((item, i) => {
                const hasWarning = warningCategories.includes(item.category);
                const rowClass = `${i % 2 ? 'alt' : ''} ${hasWarning ? 'has-warning' : ''}`.trim();
                const availableOptions = getAvailableOptions(item.category, item.code);
                return `
                <tr data-key="${item.category}" class="${rowClass}" tabindex="0" onclick="highlightParsePosition('${item.category}')">
                    <td class="col-position">${item.position}</td>
                    <td class="col-code">${item.code}${hasWarning ? '<span class="warning-badge">!</span>' : ''}</td>
                    <td class="col-category">${item.name}</td>
                    <td class="col-description ${item.description === 'Unknown code' ? 'unknown' : ''}">${item.description}</td>
                    <td class="col-options">
                        <button class="options-toggle" onclick="event.stopPropagation(); toggleOptions(this)">Show options</button>
                        <div class="options-list">${availableOptions}</div>
                    </td>
                </tr>
            `}).join('');
        }

        // Highlight position in the parse view model string visualization
        function highlightParsePosition(category) {
            const modelString = document.getElementById('model-input').value.toUpperCase();
            if (!modelString) return;

            const vizCode = document.getElementById('parse-model-viz-code');
            const pos = positionMap[category];

            let html = '';
            for (let i = 0; i < modelString.length; i++) {
                const char = modelString[i];
                const isSeparator = char === '-' || char === ':';
                const isHighlighted = pos && i >= pos[0] && i < pos[1];

                if (isHighlighted) {
                    html += `<span class="highlight">${char}</span>`;
                } else if (isSeparator) {
                    html += `<span class="separator">${char}</span>`;
                } else {
                    html += char;
                }
            }

            vizCode.innerHTML = html;

            // Also highlight the selected row
            document.querySelectorAll('.results-table tbody tr').forEach(row => {
                row.classList.remove('selected-row');
            });
            const selectedRow = document.querySelector(`tr[data-key="${category}"]`);
            if (selectedRow) {
                selectedRow.classList.add('selected-row');
            }
        }

        // Update parse visualization with full model string (no highlights)
        function updateParseVisualization() {
            const modelString = document.getElementById('model-input').value.toUpperCase();
            const vizCode = document.getElementById('parse-model-viz-code');

            if (!modelString) {
                vizCode.innerHTML = '<span class="separator">Enter a model string above</span>';
                return;
            }

            let html = '';
            for (let i = 0; i < modelString.length; i++) {
                const char = modelString[i];
                const isSeparator = char === '-' || char === ':';
                if (isSeparator) {
                    html += `<span class="separator">${char}</span>`;
                } else {
                    html += char;
                }
            }
            vizCode.innerHTML = html;
        }

        // Toggle the options list visibility
        function toggleOptions(button) {
            const optionsList = button.nextElementSibling;
            const isExpanded = optionsList.classList.toggle('expanded');
            button.textContent = isExpanded ? 'Hide options' : 'Show options';
        }

        // Get all available options for a category, highlighting the current selection
        function getAvailableOptions(category, currentCode) {
            const def = codeDefinitions[category];
            if (!def || !def.codes) return '<em>No options available</em>';

            const entries = Object.entries(def.codes);
            if (entries.length === 0) return '<em>No options available</em>';

            // Limit display to first 10 options if there are many
            const displayEntries = entries.slice(0, 15);
            const hasMore = entries.length > 15;

            let html = displayEntries.map(([code, desc]) => {
                const isCurrent = code === currentCode;
                // Truncate long descriptions
                const shortDesc = desc.length > 50 ? desc.substring(0, 47) + '...' : desc;
                return `<div class="option-item${isCurrent ? ' option-current' : ''}">
                    <span class="option-code">${code}</span>${shortDesc}
                </div>`;
            }).join('');

            if (hasMore) {
                html += `<div class="option-item"><em>...and ${entries.length - 15} more options</em></div>`;
            }

            return html;
        }

        function performSearch() {
            const query = document.getElementById('search-input').value.toLowerCase().trim();
            const resultsContainer = document.getElementById('search-results');
            const statsContainer = document.getElementById('search-stats');
            const vizContainer = document.getElementById('model-string-viz');
            const vizCode = document.getElementById('model-string-viz-code');

            if (!query) {
                resultsContainer.innerHTML = '';
                statsContainer.textContent = 'Type to search all available codes and options';
                vizContainer.style.display = 'none';
                return;
            }

            const matches = [];

            for (const [catKey, catDef] of Object.entries(codeDefinitions)) {
                for (const [code, description] of Object.entries(catDef.codes)) {
                    if (description.toLowerCase().includes(query) ||
                        catDef.name.toLowerCase().includes(query)) {
                        matches.push({
                            category: catKey,
                            position: catDef.position,
                            name: catDef.name,
                            code: code,
                            description: description
                        });
                    }
                }
            }

            statsContainer.textContent = `Found ${matches.length} result${matches.length !== 1 ? 's' : ''} for "${query}"`;

            if (matches.length === 0) {
                resultsContainer.innerHTML = '<div class="no-results">No matching codes found. Try different keywords.</div>';
                vizContainer.style.display = 'none';
                return;
            }

            // Build model string visualization with highlights
            const matchedCategories = [...new Set(matches.map(m => m.category))];
            vizCode.innerHTML = buildModelStringVisualization(matchedCategories);
            vizContainer.style.display = 'block';

            resultsContainer.innerHTML = matches.map(match => `
                <div class="search-result-row"
                     onmouseenter="highlightModelPosition('${match.category}')"
                     onmouseleave="resetModelHighlight()">
                    <div class="search-result-code">${match.code}</div>
                    <div class="search-result-info">
                        <div class="search-result-category">${match.position} - ${match.name}</div>
                        <div class="search-result-desc">${highlightMatch(match.description, query)}</div>
                    </div>
                </div>
            `).join('');
        }

        // Build the model string with highlighted positions
        function buildModelStringVisualization(highlightCategories) {
            const str = REFERENCE_MODEL_STRING;
            const highlightPositions = new Set();

            // Collect all character positions to highlight
            highlightCategories.forEach(cat => {
                const pos = positionMap[cat];
                if (pos) {
                    for (let i = pos[0]; i < pos[1]; i++) {
                        highlightPositions.add(i);
                    }
                }
            });

            // Build HTML with highlights
            let html = '';
            for (let i = 0; i < str.length; i++) {
                const char = str[i];
                const isSeparator = char === '-' || char === ':';

                if (highlightPositions.has(i)) {
                    html += `<span class="highlight">${char}</span>`;
                } else if (isSeparator) {
                    html += `<span class="separator">${char}</span>`;
                } else {
                    html += char;
                }
            }

            return html;
        }

        // Highlight a single category position on hover
        function highlightModelPosition(category) {
            const vizCode = document.getElementById('model-string-viz-code');
            vizCode.innerHTML = buildModelStringVisualization([category]);
        }

        // Reset to show all matched positions
        function resetModelHighlight() {
            const query = document.getElementById('search-input').value.toLowerCase().trim();
            if (!query) return;

            const matchedCategories = [];
            for (const [catKey, catDef] of Object.entries(codeDefinitions)) {
                for (const [code, description] of Object.entries(catDef.codes)) {
                    if (description.toLowerCase().includes(query) ||
                        catDef.name.toLowerCase().includes(query)) {
                        if (!matchedCategories.includes(catKey)) {
                            matchedCategories.push(catKey);
                        }
                    }
                }
            }

            const vizCode = document.getElementById('model-string-viz-code');
            vizCode.innerHTML = buildModelStringVisualization(matchedCategories);
        }

        function highlightMatch(text, query) {
            const regex = new RegExp(`(${escapeRegex(query)})`, 'gi');
            return text.replace(regex, '<mark>$1</mark>');
        }

        function escapeRegex(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            buildSidebar([]);
        });
    </script>
</body>
</html>